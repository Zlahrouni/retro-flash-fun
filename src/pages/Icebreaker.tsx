import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Target, Shuffle, Home, RotateCcw } from "lucide-react";

const Icebreaker = () => {
  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
  const [isCardFlipping, setIsCardFlipping] = useState(false);
  const [usedQuestions, setUsedQuestions] = useState<number[]>([]);

  // Collection Ã©tendue de questions fun et express
  const questions = [
    // Questions classiques fun
    "Si tu pouvais avoir un super-pouvoir pendant 24h, lequel choisirais-tu ?",
    "Quelle est la chose la plus bizarre que tu aies jamais mangÃ©e ?",
    "Si tu Ã©tais un emoji, lequel serais-tu et pourquoi ?",
    "Quel est ton gif de rÃ©action prÃ©fÃ©rÃ© ?",
    "Si tu pouvais Ãªtre ami avec une cÃ©lÃ©britÃ©, qui choisirais-tu ?",

    // Questions classiques fun
    "Si tu pouvais Ã©changer ta vie avec un personnage de fiction pendant une semaine, qui choisirais-tu ?",
    "Quelle application sur ton tÃ©lÃ©phone utilises-tu le plus (honteusement) ?",
    "Si tu devais manger un seul plat pour le reste de ta vie, lequel serait-ce ?",
    "Quelle est la chanson que tu connais par cÅ“ur (mais que tu nâ€™assumes pas) ?",
    "Quel serait ton animal totem selon ton humeur actuelle ?",

// Questions crÃ©atives
    "Si ton humeur Ã©tait un mÃ¨me, lequel serait-ce ?",
    "DÃ©cris la derniÃ¨re rÃ©union en une punchline de film !",
    "Si ton bureau avait une mascotte, Ã  quoi ressemblerait-elle ?",
    "Invente une nouvelle fÃªte absurde Ã  cÃ©lÃ©brer chaque annÃ©e !",
    "Si tu pouvais repeindre le ciel dâ€™une autre couleur, laquelle et pourquoi ?",

    // Questions crÃ©atives
    "Invente un nouveau nom pour ton Ã©quipe en utilisant seulement des noms d'animaux !",
    "DÃ©cris ton humeur du moment avec seulement des titres de films !",
    "Si ta vie Ã©tait un genre de musique, lequel serait-ce ?",
    "Quel serait ton slogan personnel sur un t-shirt ?",
    "Si tu pouvais renommer n'importe quel objet du quotidien, lequel et comment ?",

    // Questions nostalgie
    "Quel est le dernier truc qui t'a fait rire aux Ã©clats ?",
    "Raconte une mode de ton enfance que tu trouvais gÃ©niale !",
    "Quel dessin animÃ© regardais-tu en boucle quand tu Ã©tais petit(e) ?",
    "Quelle Ã©tait ta peur la plus irrationnelle enfant ?",
    "Quel jeu vidÃ©o/jouet t'a le plus marquÃ©(e) ?",

    // Questions rapides et fun
    "Pizza hawaÃ¯enne : crime contre l'humanitÃ© ou gÃ©nie culinaire ?",
    "Chats ou chiens ? (et explique ta trahison si tu dis chats ðŸ˜„)",
    "RÃ©vÃ¨le nous ton talent secret le plus inutile !",
    "Quelle est ta superstition la plus ridicule ?",
    "Si tu Ã©tais un personnage de sitcom, dans quelle sÃ©rie vivrais-tu ?",

    // Questions dÃ©calÃ©es
    "Explique ta journÃ©e type mais en tant que super-hÃ©ros/super-vilain !",
    "Quel objet dans cette piÃ¨ce deviendrait ton arme dans un film d'action ?",
    "Si les animaux pouvaient parler, lequel serait le plus impoli ?",
    "Invente le pire conseil possible pour rÃ©ussir sa vie !",
    "Quelle serait ta stratÃ©gie pour survivre dans un film d'horreur ?",

    // Questions hypothÃ©tiques rigolotes
    "Si tu pouvais Ã©changer de corps avec quelqu'un de l'Ã©quipe pendant 1h, qui et pourquoi ?",
    "Tu gagnes 1 million mais tu dois porter un costume de mascotte pendant 1 an. Tu acceptes ?",
    "Si tu pouvais ajouter une fonctionnalitÃ© bizarre Ã  WhatsApp, laquelle ?",
    "Quel serait ton dernier repas avant la fin du monde ?",
    "Si tu Ã©tais prÃ©sident du monde pendant 24h, quelle loi ridicule voterais-tu ?",

    // Questions team building
    "Raconte le moment le plus gÃªnant de ta carriÃ¨re (sans noms !) ",
    "Quel collÃ¨gue ferait le meilleur coÃ©quipier dans Koh Lanta ?",
    "Si notre Ã©quipe Ã©tait un boys/girls band, qui aurait quel rÃ´le ?",
    "Quelle serait la devise officielle de notre Ã©quipe ?",
    "Dans quel univers de sÃ©rie/film notre Ã©quipe s'intÃ©grerait le mieux ?",

    // Questions express crÃ©atives
    "DÃ©cris ta semaine en 3 gifs mentaux !",
    "Invente un cocktail qui reprÃ©sente ton Ã©tat d'esprit !",
    "Si ton bureau Ã©tait un lieu touristique, quelle serait sa spÃ©cialitÃ© ?",
    "Quel serait ton nom de scÃ¨ne si tu Ã©tais rappeur/rappeuse ?",
    "Transforme ton dernier projet en titre de film d'action !",

    // Questions bonus fun
    "RÃ©vÃ¨le nous ton pÃ©chÃ© mignon le plus secret (niveau bouffe) !",
    "Quel est le dernier truc complÃ¨tement inutile que tu as googlÃ© ?",
    "Si tu pouvais hacker n'importe quel Ã©cran dans le monde, qu'afficherais-tu ?",
    "Raconte nous ta thÃ©orie du complot la plus farfelue !",
    "Si tu Ã©tais un produit Amazon, quels seraient tes avis clients ?",

    // Questions de fin
    "Donne un conseil de vie en moins de 10 mots !",
    "Quel serait ton autobiographie en un seul tweet ?",
    "Si tu pouvais laisser un message Ã  toi-mÃªme d'il y a 5 ans, lequel ?",
    "Termine cette phrase : 'Ce qui me rend unique, c'est...'",
    "Partage quelque chose que tu as appris cette semaine !"
  ];

  // Fonction pour obtenir une question alÃ©atoire non utilisÃ©e
  const getRandomQuestion = () => {
    const availableQuestions = questions
        .map((_, index) => index)
        .filter(index => !usedQuestions.includes(index));

    if (availableQuestions.length === 0) {
      // Toutes les questions ont Ã©tÃ© utilisÃ©es, reset
      setUsedQuestions([]);
      return Math.floor(Math.random() * questions.length);
    }

    const randomIndex = Math.floor(Math.random() * availableQuestions.length);
    return availableQuestions[randomIndex];
  };

  // Fonction pour passer Ã  la question suivante avec effet de carte
  const nextQuestion = () => {
    setIsCardFlipping(true);

    setTimeout(() => {
      const newIndex = getRandomQuestion();
      setCurrentQuestionIndex(newIndex);
      setUsedQuestions(prev => [...prev, newIndex]);
      setIsCardFlipping(false);
    }, 300);
  };

  // RÃ©initialiser les questions
  const resetQuestions = () => {
    setUsedQuestions([]);
    setCurrentQuestionIndex(getRandomQuestion());
  };

  const currentQuestion = questions[currentQuestionIndex];
  const questionsRemaining = questions.length - usedQuestions.length;

  return (
      <div className="min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50">
        {/* Header */}
        <header className="bg-white/80 backdrop-blur-sm border-b border-purple-100 sticky top-0 z-50">
          <div className="container mx-auto px-4 py-4">
            <div className="flex items-center justify-between">
              <div className="flex items-center space-x-2">
                <div className="w-8 h-8 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg flex items-center justify-center">
                  <Target className="w-5 h-5 text-white" />
                </div>
                <h1 className="text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                  RetroFlow Icebreaker
                </h1>
              </div>
              <Button
                  variant="outline"
                  onClick={() => window.location.href = "/"}
                  className="text-gray-600 hover:text-gray-800"
              >
                <Home className="w-4 h-4 mr-2" />
                Retour Ã  l'accueil
              </Button>
            </div>
          </div>
        </header>

        {/* Main Content */}
        <main className="container mx-auto px-4 py-12">
          <div className="max-w-4xl mx-auto">
            {/* Introduction */}
            <div className="text-center mb-12">
              <h2 className="text-4xl font-bold text-gray-900 mb-4">
                Questions Icebreaker ðŸŽ¯
              </h2>
              <p className="text-xl text-gray-600 max-w-2xl mx-auto">
                Brisez la glace avec votre Ã©quipe ! Des questions fun et express pour crÃ©er des liens et rigoler ensemble.
              </p>
            </div>

            {/* Statistiques */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
              <div className="bg-white/80 backdrop-blur-sm rounded-xl p-4 border border-purple-200 text-center">
                <div className="text-2xl font-bold text-purple-600">{questions.length}</div>
                <div className="text-sm text-gray-600">Questions au total</div>
              </div>
              <div className="bg-white/80 backdrop-blur-sm rounded-xl p-4 border border-pink-200 text-center">
                <div className="text-2xl font-bold text-pink-600">{usedQuestions.length}</div>
                <div className="text-sm text-gray-600">Questions posÃ©es</div>
              </div>
              <div className="bg-white/80 backdrop-blur-sm rounded-xl p-4 border border-orange-200 text-center">
                <div className="text-2xl font-bold text-orange-600">{questionsRemaining}</div>
                <div className="text-sm text-gray-600">Questions restantes</div>
              </div>
            </div>

            {/* Carte avec la question */}
            <div className="relative mb-8">
              <div
                  className={`transition-all duration-300 transform ${
                      isCardFlipping ? 'scale-95 rotate-y-180 opacity-50' : 'scale-100 rotate-0 opacity-100'
                  }`}
                  style={{
                    transformStyle: 'preserve-3d',
                    perspective: '1000px'
                  }}
              >
                <Card className="bg-gradient-to-br from-white/90 to-white/70 backdrop-blur-sm border-2 border-purple-200 shadow-2xl min-h-[300px] relative overflow-hidden">
                  {/* Effet de brillance */}
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -skew-x-12 translate-x-[-100%] transition-transform duration-1000 group-hover:translate-x-[400%]"></div>

                  <CardContent className="p-12 text-center relative z-10">
                    <div className="mb-8">
                      <div className="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg">
                        <span className="text-2xl">ðŸŽ­</span>
                      </div>
                      <div className="text-sm text-purple-600 font-medium mb-4">
                        Question #{usedQuestions.length + 1}
                      </div>
                    </div>

                    <h3 className="text-2xl md:text-3xl font-bold text-gray-900 leading-relaxed mb-8">
                      {currentQuestion}
                    </h3>

                    <div className="flex justify-center items-center space-x-4">
                      <div className="flex space-x-2">
                        {[...Array(5)].map((_, i) => (
                            <div
                                key={i}
                                className={`w-2 h-2 rounded-full ${
                                    i < (usedQuestions.length % 5) + 1
                                        ? 'bg-purple-500'
                                        : 'bg-gray-300'
                                }`}
                            />
                        ))}
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>

              {/* Effet de cartes en arriÃ¨re-plan */}
              <div className="absolute -inset-4 -z-10">
                <Card className="bg-gradient-to-br from-purple-100/50 to-pink-100/50 backdrop-blur-sm border border-purple-100 transform rotate-2 translate-x-2 translate-y-2" />
                <Card className="bg-gradient-to-br from-pink-100/30 to-orange-100/30 backdrop-blur-sm border border-pink-100 transform -rotate-1 translate-x-1 translate-y-1 absolute inset-0" />
              </div>
            </div>

            {/* Boutons d'action */}
            <div className="flex flex-col sm:flex-row justify-center gap-4 mb-8">
              <Button
                  onClick={nextQuestion}
                  disabled={isCardFlipping}
                  size="lg"
                  className="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-8 py-4 text-lg font-semibold shadow-lg"
              >
                {isCardFlipping ? (
                    <>
                      <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"></div>
                      Nouvelle carte...
                    </>
                ) : (
                    <>
                      <Shuffle className="w-5 h-5 mr-2" />
                      Question suivante
                    </>
                )}
              </Button>

              <Button
                  onClick={resetQuestions}
                  variant="outline"
                  size="lg"
                  className="px-8 py-4 text-lg border-purple-200 text-purple-700 hover:bg-purple-50"
              >
                <RotateCcw className="w-5 h-5 mr-2" />
                Recommencer
              </Button>
            </div>

            {/* Message de fin */}
            {questionsRemaining === 0 && (
                <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-6 mb-8">
                  <div className="text-center">
                    <span className="text-4xl mb-4 block">ðŸŽ‰</span>
                    <h4 className="text-xl font-bold text-yellow-800 mb-2">
                      Toutes les questions ont Ã©tÃ© posÃ©es !
                    </h4>
                    <p className="text-yellow-700">
                      Votre Ã©quipe a fait le tour de toutes nos questions. Recommencez pour en dÃ©couvrir de nouvelles combinaisons !
                    </p>
                  </div>
                </div>
            )}

            {/* Conseils d'utilisation */}
            <Card className="bg-white/60 backdrop-blur-sm border-purple-200">
              <CardContent className="p-8">
                <h4 className="text-xl font-bold text-gray-900 mb-6 text-center">
                  ðŸ’¡ Comment bien utiliser l'icebreaker ?
                </h4>

                <div className="grid md:grid-cols-2 gap-6">
                  <div className="space-y-4">
                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span className="text-green-600 font-bold">1</span>
                      </div>
                      <div>
                        <h5 className="font-semibold text-gray-800">RÃ©ponse express</h5>
                        <p className="text-gray-600 text-sm">Chacun rÃ©pond en 30 secondes max pour garder le rythme !</p>
                      </div>
                    </div>

                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span className="text-blue-600 font-bold">2</span>
                      </div>
                      <div>
                        <h5 className="font-semibold text-gray-800">Ã€ tour de rÃ´le</h5>
                        <p className="text-gray-600 text-sm">Passez la parole dans l'ordre ou dÃ©signez qui rÃ©pond !</p>
                      </div>
                    </div>

                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span className="text-purple-600 font-bold">3</span>
                      </div>
                      <div>
                        <h5 className="font-semibold text-gray-800">Pas de jugement</h5>
                        <p className="text-gray-600 text-sm">L'objectif est de s'amuser et apprendre Ã  se connaÃ®tre !</p>
                      </div>
                    </div>
                  </div>

                  <div className="space-y-4">
                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span className="text-yellow-600 font-bold">4</span>
                      </div>
                      <div>
                        <h5 className="font-semibold text-gray-800">Rebondissez</h5>
                        <p className="text-gray-600 text-sm">N'hÃ©sitez pas Ã  poser des questions de suivi amusantes !</p>
                      </div>
                    </div>

                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-pink-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span className="text-pink-600 font-bold">5</span>
                      </div>
                      <div>
                        <h5 className="font-semibold text-gray-800">Timing parfait</h5>
                        <p className="text-gray-600 text-sm">IdÃ©al en dÃ©but de meeting ou pendant une pause !</p>
                      </div>
                    </div>

                    <div className="flex items-start space-x-3">
                      <div className="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">
                        <span className="text-orange-600 font-bold">6</span>
                      </div>
                      <div>
                        <h5 className="font-semibold text-gray-800">Gardez le fun</h5>
                        <p className="text-gray-600 text-sm">L'objectif est de crÃ©er de la cohÃ©sion et de la bonne humeur !</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="mt-8 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200">
                  <p className="text-center text-purple-700 font-medium">
                    ðŸŽ¯ <strong>Pro tip :</strong> MÃ©langez avec vos rÃ©trospectives pour crÃ©er une atmosphÃ¨re dÃ©tendue !
                  </p>
                </div>
              </CardContent>
            </Card>
          </div>
        </main>
      </div>
  );
};

export default Icebreaker;